#!/bin/sh

DUMP_FILENAME=$1
DUMP_FILENAME_UNDERSCORE=$( echo $DUMP_FILENAME | sed 's/\./_/g' )
DUMP_HEADER_FILENAME="${DUMP_FILENAME_UNDERSCORE}.h"
HEADER_GUARD="test_${DUMP_FILENAME_UNDERSCORE}_h"

> $DUMP_HEADER_FILENAME
echo "#ifndef $HEADER_GUARD" >> $DUMP_HEADER_FILENAME
echo "#ifndef $HEADER_GUARD" >> $DUMP_HEADER_FILENAME
echo "" >> $DUMP_HEADER_FILENAME
echo "namespace test" >> $DUMP_HEADER_FILENAME
echo "{" >> $DUMP_HEADER_FILENAME
echo "" >> $DUMP_HEADER_FILENAME
echo "static const char* ${DUMP_FILENAME_UNDERSCORE}=\"\\" >> $DUMP_HEADER_FILENAME
hexdump -ve '"\\" "x" 1/1 "%02X"' $DUMP_FILENAME >> $DUMP_HEADER_FILENAME
echo "\\" >> $DUMP_HEADER_FILENAME
echo "\";" >> $DUMP_HEADER_FILENAME
echo "" >> $DUMP_HEADER_FILENAME
echo "} // namespace test" >> $DUMP_HEADER_FILENAME
echo "" >> $DUMP_HEADER_FILENAME
echo "#endif // $HEADER_GUARD" >> $DUMP_HEADER_FILENAME
